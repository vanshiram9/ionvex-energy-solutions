<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Warranty Check | Ionvex Energy Solutions</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Check your Ionvex Energy battery warranty status using serial number." />

  <!-- GLOBAL CSS -->
  <link rel="stylesheet" href="/css/main.css" />

</head>
<body>

  <!-- ================= HEADER ================= -->
  <header class="main-header">
    <div class="logo">
      <img src="/assets/images/logo.png" alt="Ionvex Energy" />
      <span>Ionvex Energy</span>
    </div>

    <nav class="main-nav">
      <a href="/public/index.html">Home</a>
      <a href="/public/products.html">Products</a>
      <a href="/public/warranty.html" class="active">Warranty</a>
      <a href="/public/login.html">Login</a>
    </nav>
  </header>

  <!-- ================= WARRANTY CHECK ================= -->
  <section class="warranty-container">

    <h1>Battery Warranty Check</h1>
    <p>Enter your battery serial number to view warranty status.</p>

    <div class="warranty-form">
      <input
        type="text"
        id="serialInput"
        placeholder="Enter Battery Serial Number"
        autocomplete="off"
      />
      <button id="checkBtn" class="btn-primary">
        Check Warranty
      </button>
    </div>

    <!-- RESULT -->
    <div id="warrantyResult" class="warranty-result hidden">

      <h3>Status: <span id="statusText"></span></h3>

      <ul>
        <li><strong>Battery Model:</strong> <span id="resModel"></span></li>
        <li><strong>Customer Name:</strong> <span id="resCustomer"></span></li>
        <li><strong>Activated On:</strong> <span id="resStart"></span></li>
        <li><strong>Valid Till:</strong> <span id="resEnd"></span></li>
        <li><strong>Warranty Type:</strong> <span id="resType"></span></li>
      </ul>

    </div>

    <!-- ERROR -->
    <div id="errorBox" class="error-box hidden"></div>

  </section>

  <!-- ================= FOOTER ================= -->
  <footer class="main-footer">
    <p>Â© <span id="year"></span> Ionvex Energy Solutions. All rights reserved.</p>
  </footer>

  <!-- ================= JS ================= -->
  <script type="module">
    import { checkWarrantyBySerial } from "/js/home/warrantyQuickCheck.js";

    document.getElementById("year").textContent = new Date().getFullYear();

    const btn = document.getElementById("checkBtn");
    const serialInput = document.getElementById("serialInput");

    const resultBox = document.getElementById("warrantyResult");
    const errorBox = document.getElementById("errorBox");

    btn.addEventListener("click", async () => {
      const serial = serialInput.value.trim();

      resultBox.classList.add("hidden");
      errorBox.classList.add("hidden");

      if (!serial) {
        errorBox.textContent = "Please enter serial number";
        errorBox.classList.remove("hidden");
        return;
      }

      try {
        const data = await checkWarrantyBySerial(serial);

        if (!data) {
          errorBox.textContent = "No warranty found for this serial number";
          errorBox.classList.remove("hidden");
          return;
        }

        document.getElementById("statusText").textContent = data.status;
        document.getElementById("resModel").textContent = data.model;
        document.getElementById("resCustomer").textContent = data.customerName;
        document.getElementById("resStart").textContent = data.startDate;
        document.getElementById("resEnd").textContent = data.endDate;
        document.getElementById("resType").textContent = data.warrantyType;

        resultBox.classList.remove("hidden");

      } catch (err) {
        errorBox.textContent = "Something went wrong. Try again.";
        errorBox.classList.remove("hidden");
      }
    });
  </script>

</body>
</html>
